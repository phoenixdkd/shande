{% extends 'base_full_noheader.html' %}
{% block title %}收款汇总明细{% endblock %}
{% block content %}
<br/>
<h1>
    <div class="alert alert-success" style="text-align:center">
        收款汇总明细表
    </div>
</h1>
    <form id="searchKpiForm" method="POST" class="form-horizontal " action="#">
    <div class="form-group">
        <label class="col-md-offset-2 col-md-1 control-label">时间范围</label>
        <div class="col-md-2 ">
             <input type="date"  class="form-control datetime" value="{{ startDate }}" name="startDate" id="startDate"
             title="起始时间"/>
        </div>
        <label class="col-md-1 control-label"></label>
        <div class="col-md-2 ">
             <input type="date"  class="form-control datetime" value="{{ endDate }}" name="endDate" id="endDate"
             title="结束时间"/>
        </div>
        <label class="col-md-1 control-label"></label>
        <div class="col-md-2">
                <button type="submit" class="btn btn-sm btn-primary" >搜索</button>
        </div>
    </div>
</form>
<hr/>

<table class="table table-bordered">
    <thead class="bg-info">
        <th width="2%">序号</th>
        <th width="5%">汇款时间</th>
{#        <th width="5%">客户来源公司</th>#}
        <th width="5%">客户姓名</th>
{#        <th width="5%">客户管理专员</th>#}
        <th width="5%">电话</th>
        <th width="5%">产品代码/名称</th>
        <th width="5%">金额</th>
        <th width="5%">支付方式</th>
        <th width="5%">客户管理专员</th>
        {% if request.user.userprofile.title.role_name == 'teacher' %}
        <th width="5%">收款专员</th>
        {% else %}
        <th width="5%">客户开发专员</th>
        {% endif %}
    </thead>
    <tbody>
    {% if tradePage %}
    {% for tradeObj in tradePage %}
     <tr class="trade_row" id="trade_row_{{ tradeObj.id }}">
          <td>{{ forloop.counter }}</td>
          <td>{{ tradeObj.paytime }}</td>
          <td>{{ tradeObj.customer.name }}</td>
          <td>{{ tradeObj.customer.phone }} </td>
          <td>{{ tradeObj.stock.stockid }}/{{ tradeObj.stock.stockname }}</td>
          <td>{{ tradeObj.paycash }} </td>
          <td>{{ tradeObj.paytype }} </td>
          <td>{{ tradeObj.customer.teacher.teacherId }} {{ tradeObj.customer.teacher.binduser.userprofile.nick }}</td>
          {% if request.user.userprofile.title.role_name == 'teacher' %}
                <td>{{ tradeObj.customer.bursar.bursarId }} {{ tradeObj.customer.bursar.binduser.userprofile.nick }}</td>
          {% else %}
                <td>{{ tradeObj.customer.sales.saleId }} {{ tradeObj.customer.sales.binduser.userprofile.nick }}</td>
          {% endif %}
     </tr>
       {% empty %}
        <tr><td colspan="9">无收款信息</td></tr>
    {% endfor %}
    {% endif %}


        <tr style="color:red">
            <td></td>
            <td></td>
            <td></td>
            <td>合计</td>
            <td></td>
            <td>{{ payCashTotal }}
            <td></td>
            <td></td>
            <td></td>
        </tr>
    </tbody>
</table>


<nav class="navbar-right">
  <ul class="pagination">
    <li>
        {% if tradePage.has_previous %}
{#            <span aria-hidden="true" onclick="loadTradeDiv('page={{ tradePage.previous_page_number }}&{{ requestArgs }}')">&laquo;</span>#}
            <span aria-hidden="true">
                <a href="?page={{ tradePage.previous_page_number }}&{{ requestArgs }}">&laquo;</a>
            </span>
        {% endif %}
    </li>
    <li><span class="current">
           第{{ tradePage.number }}/{{ tradePage.paginator.num_pages }}页
        </span></li>
    <li>
        {% if tradePage.has_next %}
{#            <span aria-hidden="true" onclick="loadBursarDiv('page={{ tradePage.next_page_number }}&{{ requestArgs }}')">&raquo;</span>#}
            <span aria-hidden="true">
                <a href="?page={{ tradePage.next_page_number }}&{{ requestArgs }}">&raquo;</a>
            </span>
        {% endif %}
    </li>
  </ul>
</nav>
{% endblock %}